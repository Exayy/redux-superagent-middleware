{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///library.min.js","webpack:///webpack/bootstrap f94afe2ddfd9eb228da8","webpack:///./src/index.js","webpack:///external \"superagent\""],"names":["root","factory","exports","module","require","define","amd","this","__WEBPACK_EXTERNAL_MODULE_1__","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","goTo","action","store","next","payload","meta","console","error","res","dispatch","getState","responseHandler","response","requestFailed","body","httpCode","status","Object","defineProperty","value","_extends","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","customConfig","config","superagentMiddleware","_superagent","_superagent2","base","defaultHeaders","Content-Type","hooks","request","cancelled","requestActions","Array","requests","map","requestAction","url","method","headers","params","defaultParams","onRequest","onStart","promiseList","push","Promise","resolve","superagentRequest","query","set","send","end","err","cancel","all","then","responses","interrupted","hadError","finalPayload","finalMeta","index","test","onFailure","onError","name","onSuccess","onComplete"],"mappings":"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","file":"library.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"superagent\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"superagent\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"library\"] = factory(require(\"superagent\"));\n\telse\n\t\troot[\"library\"] = factory(root[\"superagent\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_1__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"superagent\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"superagent\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"library\"] = factory(require(\"superagent\"));\n\telse\n\t\troot[\"library\"] = factory(root[\"superagent\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_1__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\t\n\texports.default = function (customConfig) {\n\t    config = _extends({}, config, customConfig);\n\t    return superagentMiddleware;\n\t};\n\t\n\tvar _superagent = __webpack_require__(1);\n\t\n\tvar _superagent2 = _interopRequireDefault(_superagent);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar config = {\n\t    base: \"\",\n\t    defaultHeaders: {\n\t        \"Content-Type\": \"application/json\"\n\t    },\n\t    hooks: {}\n\t};\n\t\n\tfunction goTo(action, store, next, payload, meta) {\n\t\n\t    if (typeof action !== \"function\") {\n\t        /* eslint-disable no-console */\n\t        console.error(\"superagentMiddleware error : onStart, onSuccess, onError, onComplete must be functions\");\n\t        /* eslint-enable no-console */\n\t        return;\n\t    }\n\t\n\t    var res = action(payload, meta, store.dispatch, store.getState);\n\t    res && next(res);\n\t}\n\t\n\tfunction responseHandler(response) {\n\t\n\t    if (!response) {\n\t        return { error: true, meta: { requestFailed: true } };\n\t    }\n\t\n\t    var res = {\n\t        error: true,\n\t        payload: response.body,\n\t        meta: {\n\t            httpCode: response.status\n\t        }\n\t    };\n\t    if (response.status <= 300) {\n\t        res.error = false;\n\t    }\n\t\n\t    return res;\n\t}\n\t\n\tvar superagentMiddleware = function superagentMiddleware(store) {\n\t    return function (next) {\n\t        return function (action) {\n\t\n\t            if (!action.request) {\n\t                return next(action);\n\t            }\n\t\n\t            // Cancelled status\n\t            var cancelled = false;\n\t\n\t            // Requests configuration\n\t            var requestActions = action.request instanceof Array ? action.request : [action.request];\n\t            var requests = requestActions.map(function (requestAction) {\n\t                var request = {\n\t                    base: requestAction.base || config.base,\n\t                    url: requestAction.url,\n\t                    method: requestAction.method || \"GET\",\n\t                    headers: _extends({}, config.defaultHeaders, requestAction.headers || {}),\n\t                    params: _extends({}, config.defaultParams, requestAction.params || {}),\n\t                    body: requestAction.body\n\t                };\n\t\n\t                if (config.hooks.onRequest) {\n\t                    request = config.hooks.onRequest(store, action, request) || request;\n\t                }\n\t\n\t                return request;\n\t            });\n\t\n\t            // Requests execution\n\t            action.onStart && goTo(action.onStart, store, next);\n\t            var promiseList = [];\n\t            requests.map(function (request) {\n\t                promiseList.push(new Promise(function (resolve) {\n\t                    var superagentRequest = (0, _superagent2.default)(request.method, request.base + request.url);\n\t                    request.params && superagentRequest.query(request.params);\n\t                    request.headers && superagentRequest.set(request.headers);\n\t                    request.body && superagentRequest.send(request.body);\n\t                    superagentRequest.end(function (err, response) {\n\t                        resolve(response);\n\t                    });\n\t                }));\n\t            });\n\t\n\t            // Define cancel in action\n\t            action.cancel = function () {\n\t                cancelled = true;\n\t            };\n\t\n\t            // Handling responses\n\t            Promise.all(promiseList).then(function (responses) {\n\t\n\t                if (cancelled) {\n\t                    return;\n\t                }\n\t\n\t                var interrupted = false;\n\t                var hadError = false;\n\t                var finalPayload = {};\n\t                var finalMeta = {};\n\t                responses.map(function (response, index) {\n\t                    var test = responseHandler(response);\n\t\n\t                    if (test.meta.requestFailed && config.hooks.onFailure && config.hooks.onFailure(store, action, requestActions[index], response) === false || test.error && config.hooks.onError && config.hooks.onError(store, action, requestActions[index], response) === false) {\n\t                        interrupted = true;\n\t                    }\n\t                    if (test.error === true) {\n\t                        hadError = true;\n\t                    }\n\t\n\t                    if (!(action.request instanceof Array)) {\n\t                        finalPayload = test.payload, finalMeta = test.meta;\n\t                    } else {\n\t                        var name = requestActions[index].name || \"request_\" + index;\n\t                        finalPayload[name] = test.payload;\n\t                        finalMeta[name] = test.meta;\n\t                    }\n\t                });\n\t\n\t                if (!interrupted) {\n\t                    !hadError && action.onSuccess && goTo(action.onSuccess, store, next, finalPayload, finalMeta);\n\t                    hadError && action.onError && goTo(action.onError, store, next, finalPayload, finalMeta);\n\t                }\n\t                action.onComplete && goTo(action.onComplete, store, next);\n\t            });\n\t        };\n\t    };\n\t};\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n\tmodule.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n/***/ }\n/******/ ])\n});\n;\n\n\n// WEBPACK FOOTER //\n// library.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap f94afe2ddfd9eb228da8","import superagent from \"superagent\"\n\nlet config = {\n    base : \"\",\n    defaultHeaders : {\n        \"Content-Type\" : \"application/json\",\n    },\n    hooks : {},\n}\n\nfunction goTo(action, store, next, payload, meta) {\n\n    if (typeof action !== \"function\"){\n        /* eslint-disable no-console */\n        console.error(\"superagentMiddleware error : onStart, onSuccess, onError, onComplete must be functions\");\n        /* eslint-enable no-console */\n        return\n    }\n\n    const res = action(payload, meta, store.dispatch, store.getState)\n    res && next(res)\n}\n\nfunction responseHandler(response) {\n\n    if (!response) {\n        return { error : true, meta : { requestFailed : true } }\n    }\n\n    const res = { \n        error : true,\n        payload : response.body,\n        meta : {\n            httpCode : response.status,\n        },\n    }\n    if (response.status <= 300) {\n        res.error = false\n    }\n\n    return res\n}\n\nconst superagentMiddleware = store => next => action => {\n\n    if (!action.request){\n        return next(action)\n    }\n\n    // Cancelled status\n    let cancelled = false\n\n    // Requests configuration\n    const requestActions = action.request instanceof Array ? action.request : [action.request]\n    const requests = requestActions.map(requestAction => {\n        let request = {\n            base : requestAction.base || config.base,\n            url : requestAction.url,\n            method : requestAction.method || \"GET\",\n            headers : { ...config.defaultHeaders, ...(requestAction.headers || {}) },\n            params : { ...config.defaultParams, ...(requestAction.params || {}) },\n            body : requestAction.body,\n        }\n\n        if (config.hooks.onRequest) {\n            request = config.hooks.onRequest(store, action, request) || request\n        }\n\n        return request\n    })\n\n    // Requests execution\n    action.onStart && goTo(action.onStart, store, next)\n    const promiseList = []\n    requests.map(request => {\n        promiseList.push(new Promise(resolve => {\n            const superagentRequest = superagent(request.method, request.base + request.url)\n            request.params && superagentRequest.query(request.params)\n            request.headers && superagentRequest.set(request.headers)\n            request.body && superagentRequest.send(request.body)\n            superagentRequest.end((err, response) => {\n                resolve(response)\n            })\n        }))\n    })\n\n    // Define cancel in action\n    action.cancel = () => {\n        cancelled = true\n    }\n\n    // Handling responses\n    Promise.all(promiseList).then((responses) => {\n\n        if (cancelled) {\n            return\n        }\n\n        let interrupted = false\n        let hadError = false\n        let finalPayload = {}\n        let finalMeta = {}\n        responses.map((response, index) => {\n            const test = responseHandler(response)\n\n            if ((test.meta.requestFailed && config.hooks.onFailure && config.hooks.onFailure(store, action, requestActions[index], response) === false) ||\n                (test.error && config.hooks.onError && config.hooks.onError(store, action, requestActions[index], response) === false)) {\n                interrupted = true\n            }\n            if (test.error === true) {\n                hadError = true\n            }\n\n            if (!(action.request instanceof Array)){\n                finalPayload = test.payload,\n                finalMeta = test.meta\n            } else {\n                const name = requestActions[index].name || \"request_\" + index\n                finalPayload[name] = test.payload\n                finalMeta[name] = test.meta\n            }\n        })\n\n        if (!interrupted) {\n            !hadError && action.onSuccess && goTo(action.onSuccess, store, next, finalPayload, finalMeta)\n            hadError && action.onError && goTo(action.onError, store, next, finalPayload, finalMeta)\n        }\n        action.onComplete && goTo(action.onComplete, store, next)\n    })\n}\n\nexport default function(customConfig){\n    config = {...config, ...customConfig}\n    return superagentMiddleware\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"superagent\"\n// module id = 1\n// module chunks = 0"],"sourceRoot":""}